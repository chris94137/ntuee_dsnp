#! /bin/zsh
if (( $#argv == 0 )) then
  echo "Missing aag file. Using -- run.strash xx (for strashXX.aag)"
  exit 1
fi

design=strash$1.aag
if [[ ! -e $design ]] then
   echo "$design does not exists"
   exit 1
fi

dofile=do.strash
rm -f $dofile
echo "cirr $design" > $dofile
echo "cirp" >> $dofile
echo "cirp -pi" >> $dofile
echo "cirp -po" >> $dofile
echo "cirp -n" >> $dofile
echo "cirp -fl" >> $dofile
echo "cirstrash" >> $dofile
echo "cirp" >> $dofile
echo "cirp -pi" >> $dofile
echo "cirp -po" >> $dofile
echo "cirp -n" >> $dofile
echo "cirp -fl" >> $dofile
echo "q -f" >> $dofile
../fraig -f $dofile &> diff/strash$1.mine
../ref/fraig -f $dofile &> diff/strash$1.ref
echo "diff strash$1"
colordiff diff/strash$1.mine diff/strash$1.ref
